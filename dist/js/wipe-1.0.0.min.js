/*!hgf-wipe 1.0.0 发布日期：2018-11-13*/
var cas=document.getElementById("cas"),context=cas.getContext("2d"),_w=cas.width,_h=cas.height,radius=30,posX=0,posY=0,isMouseDown=!1,device=/android|webos|iPhone|ipad|ipod|blackberry|iemobile|opera mini/i.test(navigator.userAgent.toLowerCase());console.log(device);var clickEvtName=device?"touchstart":"mousedown",moveEvtName=device?"touchmove":"mousemove",upEvtName=device?"touchend":"mouseup";function drawMask(e){e.fillStyle="#666",e.fillRect(0,0,_w,_h),e.globalCompositeOperation="destination-out"}function draw(e,t,n,o,i){if(3===arguments.length)e.save(),e.beginPath(),e.fillStyle="red",e.arc(t,n,radius,0,2*Math.PI),e.fill(),e.restore();else{if(5!==arguments.length)return!1;e.save(),e.lineWidth=2*radius,e.lineCap="round",e.beginPath(),e.moveTo(t,n),e.lineTo(o,i),e.stroke(),e.restore()}}function fn1(e){if(!isMouseDown)return!1;var t=e||window.event,n=t.clientX,o=t.clientY;drawLine(context,posX,posY,n,o),posX=n,posY=o}function getTransparency(e){for(var t=e.getImageData(0,0,_w,_h),n=0,o=0;o<t.data.length;o+=4)0===t.data[o+3]&&n++;var i=n/(_w*_h)*100;return console.log("透明点的个数:"+n),console.log("占总面积"+Math.ceil(i)+"%"),Math.round(i)}function clearRech(e){e.clearRect(0,0,_w,_h)}cas.addEventListener(clickEvtName,function(e){isMouseDown=!0;var t=e||window.event;t.preventDefault(),x1=device?t.touches[0].clientX:t.clientX,y1=device?t.touches[0].clientY:t.clientY,draw(context,x1,y1)}),cas.addEventListener(moveEvtName,function(e){if(!isMouseDown)return!1;var t=e||window.event;t.preventDefault();var n=device?t.touches[0].clientX:t.clientX,o=device?t.touches[0].clientY:t.clientY;draw(context,x1,y1,n,o),x1=n,y1=o},!1),cas.addEventListener(upEvtName,function(){isMouseDown=!1,50<getTransparency(context)&&(alert("超过了50%的面积"),clearRech(context))}),window.onload=function(){drawMask(context)};